/*
Author: Peter Coxhead (http://www.cs.bham.ac.uk/~pxc/)
Copyright: Peter Coxhead, 2008-2009; released under GPLv3
  (http://www.gnu.org/licenses/gpl-3.0.html).
 */
var Matrix=new createMatrixPackage;function createMatrixPackage(){var abs=Math.abs,EPS=Math.pow(2,-40);function _chkNum(r){return abs(r)<EPS?0:r}function _chkMatrix(r,i,t){if(!t.isMatrix)throw"***ERROR: Argument "+i+" of Matrix."+r+' is not a Matrix; its value is "'+t+'".'}function _createMatrixfromArray(r){for(var i=r.length,t=0;t<i;t++){if(!(r[t]instanceof Array))throw"***ERROR: in Matrix.create: argument 1 is not a 2D array.";if(r[t].length!=r[0].length)throw"***ERROR: in Matrix.create: argument 1 has different length rows."}var o=r[0].length,a=new Array(i);for(t=0;t<i;t++){a[t]=new Array(o);for(var e=0;e<o;e++)a[t][e]=_chkNum(r[t][e])}var n=new Object;return n.m=i,n.n=o,n.mat=a,n.isMatrix=!0,n}function _createMatrixfromDimensions(r,i){for(var t=new Array(r),o=0;o<r;o++)t[o]=new Array(i);var a=new Object;return a.m=r,a.n=i,a.mat=t,a.isMatrix=!0,a}this.getEPS=function(){return EPS},this.create=function(r,i){var t=r instanceof Array;if(!t&&"number"!=typeof r)throw"***ERROR: in Matrix.create: argument 1 is not an array or a number.";if(t&&null!=i)throw"***ERROR: in Matrix.create: argument 1 is an array but argument 2 is also present.";return t?_createMatrixfromArray(r):_createMatrixfromDimensions(r,i)},this.scale=function(mo,scalar){_chkMatrix("scale",1,mo);var res=_createMatrixfromArray(mo.mat);with(res)for(var i=0;i<m;i++)for(var j=0;j<n;j++)mat[i][j]=_chkNum(scalar*mat[i][j]);return res},this.sub=function(mo1,mo2){if(_chkMatrix("sub",1,mo1),_chkMatrix("sub",2,mo2),mo1.m!=mo2.m||mo1.n!=mo2.n)throw"***ERROR: in Matrix.sub: matrix dimensions don't match.";var res=_createMatrixfromDimensions(mo1.m,mo1.n);with(res)for(var i=0;i<m;i++)for(var j=0;j<n;j++)mat[i][j]=_chkNum(mo1.mat[i][j]-mo2.mat[i][j]);return res},this.mult=function(mo1,mo2){if(_chkMatrix("mult",1,mo1),_chkMatrix("mult",2,mo2),mo1.n!=mo2.m)throw"***ERROR: in Matrix.mult: matrix dimensions don't match.";var res=_createMatrixfromDimensions(mo1.m,mo2.n),temp;with(res)for(var i=0;i<m;i++)for(var j=0;j<n;j++){temp=0;for(var k=0;k<mo1.n;k++)temp+=mo1.mat[i][k]*mo2.mat[k][j];mat[i][j]=_chkNum(temp)}return res},this.map=function(f,mo){_chkMatrix("map",2,mo);var res=_createMatrixfromDimensions(mo.m,mo.n);with(res)for(var i=0;i<m;i++)for(var j=0;j<n;j++)mat[i][j]=_chkNum(f(mo.mat[i][j]));return res},this.identity=function(m,n){var res=_createMatrixfromDimensions(m,n);with(res){for(var i=0;i<m;i++)for(var j=0;j<n;j++)mat[i][j]=0;for(var i=0;i<Math.min(m,n);i++)mat[i][i]=1}return res},this.inverse=function(r){return _chkMatrix("inverse",1,r),Matrix.solve(r,Matrix.identity(r.m,r.m))},this.solve=function(A,B){if(_chkMatrix("solve",1,A),_chkMatrix("solve",2,B),A.m==A.n)with(LUDecomposition)return solve(create(A),B);else{if(!(A.m>A.n))throw"***ERROR: in Matrix.solve: argument 1 has fewer rows than columns.";with(QRDecomposition){var temp=create(A);return solve(temp,B)}}},this.eigenstructure=function(r){if(_chkMatrix("eigenstructure",1,r),r.m!=r.n)throw"***ERROR: in Matrix.eigenstructure: argument is not a square matrix.";return EVDecomposition.create(r)}}var LUDecomposition=new createLUDecompositionPackage;function createLUDecompositionPackage(){var abs=Math.abs,min=Math.min;function _chkMatrix(r,i,t){if(!t.isMatrix)throw"***ERROR: in LUDecomposition."+r+": argument "+i+" is not a Matrix."}function _chkLUDecomposition(r,i,t){if(!t.isLUDecomposition)throw"***ERROR: in LUDecomposition."+r+": argument "+i+" is not an LUDecomposition."}function _arrange(mo,r){with(mo)for(var res=Matrix.create(m,n),i=0;i<m;i++)for(var j=0;j<n;j++)res.mat[i][j]=mat[r[i]][j];return res}this.isNonsingular=function(lud){_chkLUDecomposition("isNonsingular",1,lud);var eps=Matrix.getEPS();with(lud)for(var j=0;j<n;j++)if(abs(LU[j][j])<eps)return!1;return!0},this.create=function(r){var i,t;_chkMatrix("create",1,r);var o=Matrix.create(r.mat).mat;i=r.m,t=r.n;for(var a=new Array,e=0;e<i;e++)a[e]=e;for(var n,f=1,m=new Array(i),s=0;s<t;s++){for(e=0;e<i;e++)m[e]=o[e][s];for(e=0;e<i;e++){n=o[e];for(var c=min(e,s),u=0,v=0;v<c;v++)u+=n[v]*m[v];n[s]=m[e]-=u}var h=s;for(e=s+1;e<i;e++)abs(m[e])>abs(m[h])&&(h=e);if(h!=s){for(v=0;v<t;v++){var x=o[h][v];o[h][v]=o[s][v],o[s][v]=x}v=a[h];a[h]=a[s],a[s]=v,f=-f}if(s<i&&0!=o[s][s])for(e=s+1;e<i;e++)o[e][s]/=o[s][s]}var M=new Object;return M.LU=o,M.m=i,M.n=t,M.pivsign=f,M.piv=a,M.isLUDecomposition=!0,M},this.solve=function(lud,bmat){if(_chkMatrix("solve",2,bmat),_chkLUDecomposition("solve",1,lud),bmat.m!=lud.m)throw"***ERROR: in LUDecomposition.solve: matrix row dimensions do not agree.";if(!this.isNonsingular(lud))throw"***ERROR: in LUDecomposition.solve: matrix is singular.";var nx=bmat.n,Xmat=_arrange(bmat,lud.piv),X=Xmat.mat;with(lud){for(var k=0;k<n;k++)for(var i=k+1;i<n;i++)for(var j=0;j<nx;j++)X[i][j]-=X[k][j]*LU[i][k];for(var k=n-1;k>=0;k--){for(var j=0;j<nx;j++)X[k][j]/=LU[k][k];for(var i=0;i<k;i++)for(var j=0;j<nx;j++)X[i][j]-=X[k][j]*LU[i][k]}}return Xmat}}var EVDecomposition=new createEVDecompositionPackage;function createEVDecompositionPackage(){var r,i,t,o,a,e,n,f=Math.abs,m=Math.sqrt,s=Math.max,c=Math.min;function u(r,i){var t,o=f(r),a=f(i);return t=o>a?o*m(1+(t=i/r)*t):0!=i?a*m(1+(t=r/i)*t):0}function v(r,i,t,o){var a,e,n,m;return f(t)>f(o)?(a=(r+(n=o/t)*i)/(m=t+n*o),e=(i-n*r)/m):(a=((n=t/o)*r+i)/(m=o+n*t),e=(n*i-r)/m),{r:a,i:e}}this.create=function(h){var x=h.mat;r=h.n,a=new Array(r);for(var M=0;M<r;M++)a[M]=new Array(r);t=new Array(r),o=new Array(r),i=!0;for(var l=0;l<r&&i;l++)for(M=0;M<r&&i;M++)i=x[M][l]==x[l][M];if(i){for(M=0;M<r;M++)for(l=0;l<r;l++)a[M][l]=x[M][l];!function(){for(var i=0;i<r;i++)t[i]=a[r-1][i];for(var e=r-1;e>0;e--){for(var n=0,s=0,c=0;c<e;c++)n+=f(t[c]);if(0==n){o[e]=t[e-1];for(i=0;i<e;i++)t[i]=a[e-1][i],a[e][i]=0,a[i][e]=0}else{for(c=0;c<e;c++)t[c]/=n,s+=t[c]*t[c];var u=t[e-1],v=m(s);u>0&&(v=-v),o[e]=n*v,s-=u*v,t[e-1]=u-v;for(i=0;i<e;i++)o[i]=0;for(i=0;i<e;i++){u=t[i],a[i][e]=u,v=o[i]+a[i][i]*u;for(c=i+1;c<=e-1;c++)v+=a[c][i]*t[c],o[c]+=a[c][i]*u;o[i]=v}u=0;for(i=0;i<e;i++)o[i]/=s,u+=o[i]*t[i];var h=u/(s+s);for(i=0;i<e;i++)o[i]-=h*t[i];for(i=0;i<e;i++){u=t[i],v=o[i];for(c=i;c<=e-1;c++)a[c][i]-=u*o[c]+v*t[c];t[i]=a[e-1][i],a[e][i]=0}}t[e]=s}for(e=0;e<r-1;e++){if(a[r-1][e]=a[e][e],a[e][e]=1,0!=(s=t[e+1])){for(c=0;c<=e;c++)t[c]=a[c][e+1]/s;for(i=0;i<=e;i++){for(v=0,c=0;c<=e;c++)v+=a[c][e+1]*a[c][i];for(c=0;c<=e;c++)a[c][i]-=v*t[c]}}for(c=0;c<=e;c++)a[c][e+1]=0}for(i=0;i<r;i++)t[i]=a[r-1][i],a[r-1][i]=0;a[r-1][r-1]=1,o[0]=0}(),function(){for(var i=.5*Matrix.getEPS(),e=1;e<r;e++)o[e-1]=o[e];o[r-1]=0;for(var n=0,m=0,c=0;c<r;c++){m=s(m,f(t[c])+f(o[c]));for(var v=c;v<r&&!(f(o[v])<=i*m);)v++;if(v>c){do{1;var h=t[c],x=u(b=(t[c+1]-h)/(2*o[c]),1);b<0&&(x=-x),t[c]=o[c]/(b+x),t[c+1]=o[c]*(b+x);var M=t[c+1],l=h-t[c];for(e=c+2;e<r;e++)t[e]-=l;n+=l,b=t[v];var j=1,k=j,w=j,g=o[c+1],R=0,p=0;for(e=v-1;e>=c;e--){w=k,k=j,p=R,h=j*o[e],l=j*b,x=u(b,o[e]),o[e+1]=R*x,R=o[e]/x,b=(j=b/x)*t[e]-R*h,t[e+1]=l+R*(j*h+R*t[e]);for(var _=0;_<r;_++)l=a[_][e+1],a[_][e+1]=R*a[_][e]+j*l,a[_][e]=j*a[_][e]-R*l}b=-R*p*w*g*o[c]/M,o[c]=R*b,t[c]=j*b}while(f(o[c])>i*m)}t[c]=t[c]+n,o[c]=0}for(e=0;e<r-1;e++){_=e;for(var b=t[e],A=e+1;A<r;A++)t[A]<b&&(_=A,b=t[A]);if(_!=e){t[_]=t[e],t[e]=b;for(A=0;A<r;A++)b=a[A][e],a[A][e]=a[A][_],a[A][_]=b}}}()}else{e=new Array(r);for(M=0;M<r;M++)e[M]=new Array(r);n=new Array(r);for(l=0;l<r;l++)for(M=0;M<r;M++)e[M][l]=x[M][l];!function(){for(var i=r-1,t=1;t<=i-1;t++){for(var o=0,s=t;s<=i;s++)o+=f(e[s][t-1]);if(0!=o){var c=0;for(s=i;s>=t;s--)n[s]=e[s][t-1]/o,c+=n[s]*n[s];var u=m(c);n[t]>0&&(u=-u),c-=n[t]*u,n[t]=n[t]-u;for(var v=t;v<r;v++){var h=0;for(s=i;s>=t;s--)h+=n[s]*e[s][v];h/=c;for(s=t;s<=i;s++)e[s][v]-=h*n[s]}for(s=0;s<=i;s++){for(h=0,v=i;v>=t;v--)h+=n[v]*e[s][v];h/=c;for(v=t;v<=i;v++)e[s][v]-=h*n[v]}n[t]=o*n[t],e[t][t-1]=o*u}}for(s=0;s<r;s++)for(v=0;v<r;v++)a[s][v]=s==v?1:0;for(t=i-1;t>=1;t--)if(0!=e[t][t-1]){for(s=t+1;s<=i;s++)n[s]=e[s][t-1];for(v=t;v<=i;v++){for(u=0,s=t;s<=i;s++)u+=n[s]*a[s][v];u=u/n[t]/e[t][t-1];for(s=t;s<=i;s++)a[s][v]+=u*n[s]}}}(),function(){for(var i,n,u,h,x=.5*Matrix.getEPS(),M=r,l=M-1,j=M-1,k=0,w=0,g=0,R=0,p=0,_=0,b=0,A=0;A<M;A++){(A<0||A>j)&&(t[A]=e[A][A],o[A]=0);for(var D=s(A-1,0);D<M;D++)b+=f(e[A][D])}for(var E=0;l>=0;){for(var y=l;y>0&&(0==(p=f(e[y-1][y-1])+f(e[y][y]))&&(p=b),!(f(e[y][y-1])<x*p));)y--;if(y==l)e[l][l]=e[l][l]+k,t[l]=e[l][l],o[l]=0,l--,E=0;else if(y==l-1){if(n=e[l][l-1]*e[l-1][l],w=(e[l-1][l-1]-e[l][l])/2,_=m(f(g=w*w+n)),e[l][l]=e[l][l]+k,e[l-1][l-1]=e[l-1][l-1]+k,u=e[l][l],g>=0){_=w>=0?w+_:w-_,t[l-1]=u+_,t[l]=t[l-1],0!=_&&(t[l]=u-n/_),o[l-1]=0,o[l]=0,w=(u=e[l][l-1])/(p=f(u)+f(_)),w/=R=m(w*w+(g=_/p)*g),g/=R;for(D=l-1;D<M;D++)_=e[l-1][D],e[l-1][D]=g*_+w*e[l][D],e[l][D]=g*e[l][D]-w*_;for(A=0;A<=l;A++)_=e[A][l-1],e[A][l-1]=g*_+w*e[A][l],e[A][l]=g*e[A][l]-w*_;for(A=0;A<=j;A++)_=a[A][l-1],a[A][l-1]=g*_+w*a[A][l],a[A][l]=g*a[A][l]-w*_}else t[l-1]=u+w,t[l]=u+w,o[l-1]=_,o[l]=-_;l-=2,E=0}else{if(u=e[l][l],h=0,n=0,y<l&&(h=e[l-1][l-1],n=e[l][l-1]*e[l-1][l]),10==E){k+=u;for(A=0;A<=l;A++)e[A][A]-=u;u=h=.75*(p=f(e[l][l-1])+f(e[l-1][l-2])),n=-.4375*p*p}if(30==E&&(p=(p=(h-u)/2)*p+n)>0){p=m(p),h<u&&(p=-p),p=u-n/((h-u)/2+p);for(A=0;A<=l;A++)e[A][A]-=p;k+=p,u=h=n=.964}E+=1;for(var d=l-2;d>=y&&(w=((R=u-(_=e[d][d]))*(p=h-_)-n)/e[d+1][d]+e[d][d+1],g=e[d+1][d+1]-_-R-p,R=e[d+2][d+1],w/=p=f(w)+f(g)+f(R),g/=p,R/=p,d!=y)&&!(f(e[d][d-1])*(f(g)+f(R))<x*(f(w)*(f(e[d-1][d-1])+f(_)+f(e[d+1][d+1]))));)d--;for(A=d+2;A<=l;A++)e[A][A-2]=0,A>d+2&&(e[A][A-3]=0);for(var L=d;L<=l-1;L++){var U=L!=l-1;if(L!=d&&(w=e[L][L-1],g=e[L+1][L-1],R=U?e[L+2][L-1]:0,0!=(u=f(w)+f(g)+f(R))&&(w/=u,g/=u,R/=u)),0==u)break;if(p=m(w*w+g*g+R*R),w<0&&(p=-p),0!=p){L!=d?e[L][L-1]=-p*u:y!=d&&(e[L][L-1]=-e[L][L-1]),u=(w+=p)/p,h=g/p,_=R/p,g/=w,R/=w;for(D=L;D<M;D++)w=e[L][D]+g*e[L+1][D],U&&(w+=R*e[L+2][D],e[L+2][D]=e[L+2][D]-w*_),e[L][D]=e[L][D]-w*u,e[L+1][D]=e[L+1][D]-w*h;for(A=0;A<=c(l,L+3);A++)w=u*e[A][L]+h*e[A][L+1],U&&(w+=_*e[A][L+2],e[A][L+2]=e[A][L+2]-w*R),e[A][L]=e[A][L]-w,e[A][L+1]=e[A][L+1]-w*g;for(A=0;A<=j;A++)w=u*a[A][L]+h*a[A][L+1],U&&(w+=_*a[A][L+2],a[A][L+2]=a[A][L+2]-w*R),a[A][L]=a[A][L]-w,a[A][L+1]=a[A][L+1]-w*g}}}}if(0!=b){for(l=M-1;l>=0;l--)if(w=t[l],0==(g=o[l])){y=l;e[l][l]=1;for(A=l-1;A>=0;A--){n=e[A][A]-w,R=0;for(D=y;D<=l;D++)R+=e[A][D]*e[D][l];if(o[A]<0)_=n,p=R;else if(y=A,0==o[A]?e[A][l]=0!=n?-R/n:-R/(x*b):(u=e[A][A+1],h=e[A+1][A],i=(u*p-_*R)/(g=(t[A]-w)*(t[A]-w)+o[A]*o[A]),e[A][l]=i,f(u)>f(_)?e[A+1][l]=(-R-n*i)/u:e[A+1][l]=(-p-h*i)/_),x*(i=f(e[A][l]))*i>1)for(D=A;D<=l;D++)e[D][l]=e[D][l]/i}}else if(g<0){y=l-1;if(f(e[l][l-1])>f(e[l-1][l]))e[l-1][l-1]=g/e[l][l-1],e[l-1][l]=-(e[l][l]-w)/e[l][l-1];else{var O=v(0,-e[l-1][l],e[l-1][l-1]-w,g);e[l-1][l-1]=O.r,e[l-1][l]=O.i}e[l][l-1]=0,e[l][l]=1;for(A=l-2;A>=0;A--){var P,N,S,X;P=0,N=0;for(D=y;D<=l;D++)P+=e[A][D]*e[D][l-1],N+=e[A][D]*e[D][l];if(n=e[A][A]-w,o[A]<0)_=n,R=P,p=N;else{if(y=A,0==o[A]){O=v(-P,-N,n,g);e[A][l-1]=O.r,e[A][l]=O.i}else{u=e[A][A+1],h=e[A+1][A],S=(t[A]-w)*(t[A]-w)+o[A]*o[A]-g*g,X=2*(t[A]-w)*g,0==S&&0==X&&(S=x*b*(f(n)+f(g)+f(u)+f(h)+f(_)));O=v(u*R-_*P+g*N,u*p-_*N-g*P,S,X);if(e[A][l-1]=O.r,e[A][l]=O.i,f(u)>f(_)+f(g))e[A+1][l-1]=(-P-n*e[A][l-1]+g*e[A][l])/u,e[A+1][l]=(-N-n*e[A][l]-g*e[A][l-1])/u;else{O=v(-R-h*e[A][l-1],-p-h*e[A][l],_,g);e[A+1][l-1]=O.r,e[A+1][l]=O.i}}if(x*(i=s(f(e[A][l-1]),f(e[A][l])))*i>1)for(D=A;D<=l;D++)e[D][l-1]=e[D][l-1]/i,e[D][l]=e[D][l]/i}}}for(A=0;A<M;A++)if(A<0||A>j)for(D=A;D<M;D++)a[A][D]=e[A][D];for(D=M-1;D>=0;D--)for(A=0;A<=j;A++){_=0;for(L=0;L<=c(D,j);L++)_+=a[A][L]*e[L][D];a[A][D]=_}}}()}var j=Matrix.getEPS();for(M=0;M<r;M++)f(t[M])<j&&(t[M]=0),f(o[M])<j&&(o[M]=0);for(M=0;M<r-1;M++){var k=t[M],w=M;for(l=M+1;l<r;l++){var g=!1;if(0!=t[l])if(0==k)g=!0;else{var R=t[l]-k;R>j?g=!0:f(R)<j&&(g=o[l]>o[w])}g&&(k=t[l],w=l)}if(M!=w){var p=t[M];t[M]=t[w],t[w]=p,p=o[M],o[M]=o[w],o[w]=p;for(l=0;l<r;l++)p=a[l][M],a[l][M]=a[l][w],a[l][w]=p}0==t[M]&&0==o[M]||M}0==t[r-1]&&o[r-1];var _=new Object;return _.V=Matrix.create(a),_.lr=t,_.li=o,_.isSymmetric=i,_.isEVDecomposition=!0,_}}function eigenvalues(r,i){return Matrix.eigenstructure(Matrix.mult(Matrix.inverse(r),i)).lr.sort(function(r,i){return r-i})}function eigenvectors(r,i,t){let o=Matrix.eigenstructure(Matrix.sub(i,Matrix.scale(r,t))).V.mat;return[o[0][2],o[1][2],o[2][2]]}